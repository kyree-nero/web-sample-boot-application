(function(e){function t(t){for(var r,c,s=t[0],l=t[1],a=t[2],u=0,f=[];u<s.length;u++)c=s[u],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&f.push(o[c][0]),o[c]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,a||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var a=0;a<s.length;a++)t(s[a]);var d=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1bdc":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function o(e,t,n,o,i,c){var s=Object(r["i"])("banner"),l=Object(r["i"])("samples");return Object(r["e"])(),Object(r["c"])(r["a"],null,[Object(r["d"])(s,{csrfToken:i.csrfToken},null,8,["csrfToken"]),Object(r["d"])(l,{msg:"Welcome to Your Vue.js App",onCsrfTokenEvent:c.csrfTokenEvent},null,8,["onCsrfTokenEvent"])],64)}var i={align:"right"},c={id:"logoutFormId",action:"logout",method:"POST"},s=Object(r["d"])("button",{onclick:"javascript:submit()"},"sign off",-1);function l(e,t,n,o,l,a){return Object(r["e"])(),Object(r["c"])("div",i,[Object(r["d"])("form",c,[Object(r["d"])("input",{id:"csrfId",name:"_csrf",type:"hidden",value:n.csrfToken},null,8,["value"]),s])])}var a={name:"banner",props:["csrfToken"],data:function(){return{}}};a.render=l;var d=a,u=Object(r["o"])("data-v-71c4bee4");Object(r["g"])("data-v-71c4bee4");var f={align:"left"},p=Object(r["d"])("p",null,"contents:",-1),b={key:0},h={key:1},m={key:2};Object(r["f"])();var j=u((function(e,t,n,o,i,c){return Object(r["e"])(),Object(r["c"])("div",f,[Object(r["d"])("form",{onSubmit:t[3]||(t[3]=Object(r["n"])((function(){return c.submitForm.apply(c,arguments)}),["prevent"]))},[p,i.loading?(Object(r["e"])(),Object(r["c"])("p",b,"Loading")):!i.loading&&i.error?(Object(r["e"])(),Object(r["c"])("p",h,Object(r["j"])(this.error))):i.loading||i.samples&&0!==i.samples.length?(Object(r["e"])(!0),Object(r["c"])(r["a"],{key:3},Object(r["h"])(i.samples,(function(e){return Object(r["e"])(),Object(r["c"])("div",{key:e.id,align:"left"},[(Object(r["e"])(!0),Object(r["c"])(r["a"],null,Object(r["h"])(c.getErrorsByTypeAndId("update",e.id),(function(t){return Object(r["m"])((Object(r["e"])(),Object(r["c"])("ul",{key:t.id},[Object(r["d"])("li",null,Object(r["j"])(t.message),1)],512)),[[r["l"],i.errors&&0!=c.getErrorsByTypeAndId("update",e.id).length]])})),128)),Object(r["d"])("button",{type:"button",id:"delete{{ sample.id }}",onClick:function(t){i.editing=null,c.remove(e.id)}},"Delete",8,["onClick"]),Object(r["m"])(Object(r["d"])("button",{type:"button",id:"edit{{ sample.id }}",onClick:function(t){return c.openForEdit(e.id)}},"Edit",8,["onClick"]),[[r["l"],null===i.editing]]),Object(r["m"])(Object(r["d"])("button",{type:"button",id:"save{{ sample.id }}",onClick:function(t){return c.update(e)}},"Save",8,["onClick"]),[[r["l"],null!=i.editing&&i.editing==e.id]]),Object(r["m"])(Object(r["d"])("button",{type:"button",id:"cancel{{ sample.id }}",onClick:function(t){i.editing=null,c.cancelEdit(e.id)}},"Cancel",8,["onClick"]),[[r["l"],null!=i.editing&&i.editing==e.id]]),Object(r["m"])(Object(r["d"])("span",null,Object(r["j"])(e.content),513),[[r["l"],i.editing!=e.id]]),Object(r["m"])(Object(r["d"])("input",{type:"text",id:"update{{ sample.id }}","onUpdate:modelValue":function(t){return e.content=t},disabled:i.editing!=e.id},null,8,["onUpdate:modelValue","disabled"]),[[r["k"],e.content],[r["l"],i.editing==e.id]])])})),128)):(Object(r["e"])(),Object(r["c"])("p",m," There is no data ")),(Object(r["e"])(!0),Object(r["c"])(r["a"],null,Object(r["h"])(c.getErrorsByType("add"),(function(e){return Object(r["m"])((Object(r["e"])(),Object(r["c"])("ul",{key:e.id},[Object(r["d"])("li",null,Object(r["j"])(e.message),1)],512)),[[r["l"],i.errors&&0!=c.getErrorsByType("add").length]])})),128)),Object(r["d"])("button",{type:"button",id:"add",onClick:t[1]||(t[1]=function(e){return c.add()}),align:"left"},"Add"),Object(r["m"])(Object(r["d"])("input",{type:"text",id:"addContent","onUpdate:modelValue":t[2]||(t[2]=function(e){return i.newSampleContent=e}),align:"left"},null,512),[[r["k"],i.newSampleContent]])],32)])})),O=(n("4de4"),n("d3b7"),n("ddb0"),n("b85c")),g={name:"samples",props:{msg:String},data:function(){return{editing:null,oldValue:null,newSampleContent:null,samples:[],csrfToken:null,csrfTokenHeaderName:"x-csrf-token",loading:!1,error:null,errors:[]}},methods:{clearErrorsByType:function(e){var t=this.errors.filter((function(t){if(t.type!=e)return t}));this.errors=t},getErrorsByType:function(e){var t=this.errors.filter((function(t){if(t.type==e)return t}));return t},getErrorsByTypeAndId:function(e,t){var n=this.errors.filter((function(n){if(n.type==e&&n.affectedId&&n.affectedId==t)return n}));return n},handleOkResponseWithReload:function(e){return setTimeout((function(){console.log("timer done")}),2e3),this.loadSamples(),e.json()},handleBadUpdateRequest:function(e){for(var t in e.errors){var n={message:e.errors[t].defaultMessage,type:"update",field:e.errors[t].field,affectedId:this.editing};console.log("---"),console.log(n),this.errors.push(n)}},handleBadAddRequest:function(e){for(var t in e.errors){var n={message:e.errors[t].defaultMessage,type:"add",field:e.errors[t].field};console.log("---"),console.log(n),this.errors.push(n)}},handleResponse:function(e,t){if(console.log(t),e.ok&&"add"==t)this.handleOkResponseWithReload(e);else if(e.ok&&"update"==t)this.editing=null,this.handleOkResponseWithReload(e);else if(400==e.status&&"add"==t)e.json().then(this.handleBadAddRequest);else{if(400!=e.status||"update"!=t)throw new Error("server side error, please retry");e.json().then(this.handleBadUpdateRequest)}},handleErrorResponse:function(e){this.error="There was an error processing the request, please reload the page and try again",console.log(e)},openForEdit:function(e){this.editing=e;var t=this.samples.filter((function(t){if(t.id==e)return t}));t.length>0&&(this.oldValue=t[0].content)},cancelEdit:function(e){this.clearErrorsByType("update");var t=this.samples.filter((function(t){if(t.id==e)return t}));t.length>0&&(t[0].content=this.oldValue)},add:function(){var e=this;this.error=null,this.clearErrorsByType("add"),fetch("/sample",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.csrfToken},body:JSON.stringify({content:this.newSampleContent})}).then((function(t){e.handleResponse(t,"add")})).catch((function(t){e.handleErrorResponse(t)})),this.newSampleContent=null},update:function(e){var t=this;this.error=null,this.clearErrorsByType("update"),fetch("/sample/"+e.id,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.csrfToken},body:JSON.stringify(e)}).then((function(e){t.handleResponse(e,"update")})).catch((function(e){t.handleErrorResponse(e)}))},remove:function(e){var t=this;this.error=null,console.log("remove item"),fetch("/sample/"+e,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.csrfToken}}).then((function(e){if(e.ok)return setTimeout((function(){console.log("timer done")}),2e3),t.loadSamples(),e;throw new Error("server side error, please retry")})).catch((function(e){t.handleErrorResponse(e)}))},submitForm:function(){console.log("submit form")},loadSamples:function(){var e=this;this.error=null,fetch("/sample").then((function(t){if(t.ok){var n,r=Object(O["a"])(t.headers.entries());try{for(r.s();!(n=r.n()).done;){var o=n.value;o[0]===e.csrfTokenHeaderName&&(e.csrfToken=o[1],e.$emit("csrf-token-event",e.csrfToken))}}catch(i){r.e(i)}finally{r.f()}return t.json()}throw new Error("server side error, please retry")})).then((function(t){var n=[];for(var r in t)n.push({id:t[r].id,content:t[r].content,version:t[r].version});e.samples=n})).catch((function(t){e.handleErrorResponse(t)}))}},mounted:function(){console.log("start form"),this.loadSamples()}};n("f13b");g.render=j,g.__scopeId="data-v-71c4bee4";var y=g,v={name:"App",components:{banner:d,samples:y},data:function(){return{csrfToken:null}},methods:{csrfTokenEvent:function(e){console.log("in main "+e),this.csrfToken=e}}};n("64be");v.render=o;var k=v;Object(r["b"])(k).mount("#app")},"64be":function(e,t,n){"use strict";n("c894")},c894:function(e,t,n){},f13b:function(e,t,n){"use strict";n("1bdc")}});
//# sourceMappingURL=app.129f21cf.js.map